<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualize Cytometry data with ggplot • ggcyto</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Visualize Cytometry data with ggplot">
<meta property="og:description" content="With the dedicated fortify method implemented for flowSet,
    ncdfFlowSet and GatingSet classes, both raw and gated flow cytometry data
    can be plotted directly with ggplot. ggcyto wrapper and some customed
    layers also make it easy to add gates and population statistics to the
    plot.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggcyto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Top_features_of_ggcyto.html">ggcyto : Visualize `Cytometry` data with `ggplot`</a>
    </li>
    <li>
      <a href="articles/advanced/ggplot.flowSet.1d.html">1d historgram/density plot of cytometry data with ggplot2</a>
    </li>
    <li>
      <a href="articles/advanced/ggplot.flowSet.2d.html">2d scatter plot of cytometry data with ggplot2</a>
    </li>
    <li>
      <a href="articles/advanced/ggplot.flowSet.gate.html">Visualize gates on cytometry data with ggplot2</a>
    </li>
    <li>
      <a href="articles/advanced/ggplot.flowSet.overlay.html">Add overlay plot with ggplot2</a>
    </li>
    <li>
      <a href="articles/autoplot.html">Quick plot for cytometry data</a>
    </li>
    <li>
      <a href="articles/ggcyto.GatingSet.html">Visualize GatingSet with ggcyto</a>
    </li>
    <li>
      <a href="articles/ggcyto.flowSet.html">Visualize flowSet with ggcyto</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RGLab/ggcyto">
    <span class="fas fa fa fas fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="section" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#section" class="anchor"></a><img src="logo_mid.png" align="right">
</h1></div>
</div>
<div id="ggcyto--visualize-cytometry-data-with-ggplot" class="section level1">
<h1 class="hasAnchor">
<a href="#ggcyto--visualize-cytometry-data-with-ggplot" class="anchor"></a>ggcyto : Visualize <code>Cytometry</code> data with <code>ggplot</code>
</h1>
<p><code>ggcyto</code> is a cytometry data visualization tool built around ggplot and the grammar of graphics paradigm. The software extends the popular ggplot2 framework, already familiar to many data scientists, enabling it to recog-nize the core Bioconductor flow cytometry data structures for gated and annotated cytometry data. It simplifies visualization and plotting of flow data for publication quality graphics.</p>
<p>There are three ways to construct the <code>ggcyto</code> plots. Each represents a different level of complexity and flexibility. They meet the needs of various plot applications and thus are suitable for users at different levels of coding skills.</p>
</div>
<div id="quick-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-plot" class="anchor"></a>Quick plot</h1>
<p>This inherits the spirit from ggplot’s <code>Quick plot</code>, which simplies the plotting job by hiding more details from users and taking more assumptions for the plot.</p>
<ul>
<li>see <a href="vignettes/autoplot.html">autoplot</a>
</li>
</ul>
</div>
<div id="more-flexibility-with-ggcyto-wrapper" class="section level1">
<h1 class="hasAnchor">
<a href="#more-flexibility-with-ggcyto-wrapper" class="anchor"></a>More flexibility with <strong>ggcyto</strong> wrapper</h1>
<p><code>ggcyto</code> constructor along with overloaded <code><a href="reference/ggcyto_add.html">+</a></code> operator gives user more flexibility to fine-tune the plot yet still encapsulates lots of details that might be tedious and intimidating for many users.</p>
<p>See more examples of <code>ggcyto</code> constructor here:</p>
<ul>
<li><a href="vignettes/ggcyto.flowSet.html">ggcyto + flowSet</a></li>
<li><a href="vignettes/ggcyto.GatingSet.html">ggcyto + GatingSet</a></li>
</ul>
</div>
<div id="use-ggplot-directly-to-have-more-controls" class="section level1">
<h1 class="hasAnchor">
<a href="#use-ggplot-directly-to-have-more-controls" class="anchor"></a>Use <code>ggplot</code> directly to have more controls.</h1>
<p>The package overloads ggplot’s <code>fortify</code> S3 method so that <code>Cytometry</code> data structures (e.g. <code>flowSet/flowFrame</code>) are fully compatible with <code>ggplot</code>. More examples of using <code>ggplot</code> directly on <code>flowSet</code>:</p>
<ul>
<li><a href="vignettes/advanced/ggplot.flowSet.1d.html">ggplot + flowSet1d</a></li>
<li><a href="vignettes/advanced/ggplot.flowSet.2d.html">ggplot + flowSet2d</a></li>
<li><a href="vignettes/advanced/ggplot.flowSet.gate.html">ggplot + flowSet + gate</a></li>
<li><a href="vignettes/advanced/ggplot.flowSet.overlay.html">ggplot + flowSet + overlay</a></li>
</ul>
</div>
<div id="quick-demos-of-some-most-used-features" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-demos-of-some-most-used-features" class="anchor"></a>quick demos of some most used features</h1>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggcyto</span>)
<span class="no">dataDir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,<span class="kw">package</span><span class="kw">=</span><span class="st">"flowWorkspaceData"</span>)
<span class="no">gs_orig</span> <span class="kw">&lt;-</span> <span class="fu">load_gs</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="no">dataDir</span>, <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"gs_bcell_auto"</span>,<span class="kw">full</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="no">gs</span> <span class="kw">&lt;-</span> <span class="fu">gs_clone</span>(<span class="no">gs_orig</span>)</pre></div>
<div class="sourceCode" id="cb2"><pre class="r"><span class="co">#plot a gate by specifying the population node name (here it is 'CD3')</span>
<span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">gs</span>, <span class="st">"CD3"</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co">#change the resolution</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">gs</span>, <span class="st">"CD3"</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">64</span>)
<span class="no">p</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-2.png"><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co">#display the transformed value at breaks label by turning off the inverse transform</span>
<span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">gs</span>, <span class="st">"CD3"</span>, <span class="kw">axis_inverse_trans</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-5-3.png"><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="co">#you can switch the limits from default `instrument` to the actual `data` range</span>
<span class="no">p</span> + <span class="fu"><a href="reference/ggcyto_par_set.html">ggcyto_par_set</a></span>(<span class="kw">limits</span> <span class="kw">=</span> <span class="st">"data"</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-5-4.png"><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="co"># Choose between `marker` and `channel` names for axis label text</span>
<span class="no">p</span> + <span class="fu"><a href="reference/labs_cyto.html">labs_cyto</a></span>(<span class="st">"channel"</span>) <span class="co">#default is "both"</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-5.png"><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="co"># overlay another population 'IgD-CD27-' as dots on top of the existing plot</span>
<span class="no">p</span> + <span class="fu"><a href="reference/geom_overlay.html">geom_overlay</a></span>(<span class="st">"IgD-CD27-"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"purple"</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-5-6.png"><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="co"># plot a population without gate</span>
<span class="no">fs</span> <span class="kw">&lt;-</span> <span class="fu">gs_pop_get_data</span>(<span class="no">gs</span>, <span class="st">"CD20"</span>) <span class="co">#extract the gated data as a flowSet</span>
<span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">fs</span>, <span class="st">"CD20"</span>, <span class="st">"CD19"</span>) <span class="co">#plot 2D</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-7.png"><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">gs1</span> <span class="kw">&lt;-</span> <span class="no">gs</span>[<span class="fl">1</span>]
<span class="no">gs2</span> <span class="kw">&lt;-</span> <span class="no">gs</span>[<span class="fl">2</span>]
<span class="co">#construct the ggcyto object for gs1</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ggcyto.html">ggcyto</a></span>(<span class="no">gs1</span>, <span class="fu">aes</span>(<span class="no">cd24</span>, <span class="no">cd38</span>)) + <span class="fu">geom_hex</span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">128</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu"><a href="reference/geom_gate.html">geom_gate</a></span>(<span class="st">"Transitional"</span>) <span class="co">#add gate</span>
<span class="co">#customize the stats layer</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu"><a href="reference/geom_stats.html">geom_stats</a></span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"count"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>,  <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"green"</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="fl">0.7</span>)
<span class="co">#customize the layer</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu"><a href="reference/labs_cyto.html">labs_cyto</a></span>(<span class="st">"channel"</span>)
<span class="co">#customize the axis limits</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu"><a href="reference/ggcyto_par_set.html">ggcyto_par_set</a></span>(<span class="kw">limits</span> <span class="kw">=</span> <span class="st">"instrument"</span>)
<span class="co">#add another population as the overlay dots</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu"><a href="reference/geom_overlay.html">geom_overlay</a></span>(<span class="st">"IgD-CD27-"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1.2</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.4</span>)
<span class="co">#hide the legend</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span> + <span class="fu">guides</span>(<span class="kw">fill</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">p</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="co">#replace the data with gs2 and see the same visual effect</span>
<span class="no">p</span> <span class="kw">%+%</span> <span class="no">gs2</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-2.png"><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">fs</span>, <span class="st">"CD20"</span>) <span class="co">#1d density</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="co">#extract one sample as a flowFrame</span>
<span class="no">fr</span> <span class="kw">&lt;-</span> <span class="no">fs</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="co">#plot 1d density on all available channels</span>
<span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">fr</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-8-1.png"><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">gh</span> <span class="kw">&lt;-</span> <span class="no">gs</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="co"># extract a `GatingHierarchy` object for one sample</span>
<span class="co"># layout multiple cell populations with their asssociated gates in the same plot.</span>
<span class="no">nodes</span> <span class="kw">&lt;-</span> <span class="fu">gs_get_pop_paths</span>(<span class="no">gh</span>)[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>:<span class="fl">9</span>, <span class="fl">14</span>)]
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/autoplot.html">autoplot</a></span>(<span class="no">gh</span>, <span class="no">nodes</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">64</span>)
<span class="no">p</span></pre></div>
<p><img src="reference/figures/unnamed-chunk-9-1.png"><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="co">#arrange it as one-row gtable object</span>
<span class="no">gt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ggcyto_arrange.html">ggcyto_arrange</a></span>(<span class="no">p</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">gt</span>)</pre></div>
<p><img src="reference/figures/unnamed-chunk-10-1.png"><!-- --></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/ggcyto">https://​www.bioconductor.org/​packages/​ggcyto</a>
</li>
<li>Browse source code at <br><a href="https://github.com/RGLab/ggcyto/">https://​github.com/​RGLab/​ggcyto/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing ggcyto</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mike Jiang,Jake Wagner <jpwagner><br><small class="roles"> Maintainer </small>  </jpwagner>
</li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mike Jiang,Jake Wagner <jpwagner>.</jpwagner></p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
